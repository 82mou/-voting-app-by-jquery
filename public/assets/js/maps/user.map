{"version":3,"sources":["webpack:///webpack/bootstrap c8348120fac58e96e603","webpack:///./src/js/user.js"],"names":["TRANSITION_END","ANIMATION_END","database","firebase","refTitle","ref","refCount","refName","refComment","refCountStop","refView","$title","$","titleObj","nameObj","$post","$submit","$form","countObj","commentObj","$count","countStop","$layer","$layerLoading","$layerCountStop","defRenderTitle","text","value","renderTitle","title","defRenderCount","$targetCountObj","id","checkFontSize","renderCount","key","parseInt","$targetCountObjPost","closest","addClass","defRenderName","renderName","postActionCount","initial","countVal","arg","show","update","then","res","setTimeout","hide","postActionComment","commentVal","push","on","e","currentTarget","data","preventDefault","find","val","snapshot","console","log","snapshotObj","removeClass","view","showCountStop","hideCountStop","targetCountObj","$countTextLength","length","one"],"mappings":"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","file":"user.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/assets/js/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap c8348120fac58e96e603","const TRANSITION_END = 'transitionend';// 2つ指定していると2回バインドされる\nconst ANIMATION_END = 'animationend';// 2つ指定していると2回バインドされる\n\n/*\n * 初期化\n */\nlet database = firebase.database();\nlet refTitle = database.ref('title');\nlet refCount = database.ref('count');\nlet refName = database.ref('name');\nlet refComment = database.ref('comment');\nlet refCountStop = database.ref('countStop');\nlet refView = database.ref('view');\nlet $title = $('.js-title');\nlet titleObj = {};\nlet nameObj = {};\nlet $post = $('.js-post');\nlet $submit = $('.js-submit');\nlet $form = $('#js-form');\nlet countObj = {};\nlet commentObj = {};\n\nlet $count = $('.js-count');\n\nlet countStop = false;\n\nlet $layer = $('.js-layer');\nlet $layerLoading = $('.js-layer-loading');\nlet $layerCountStop = $('.js-layer-count-stop');\n\n/*\n * View\n * ・タイトル表示\n * ・カウント表示\n * ・名前表示\n */\n\nlet defRenderTitle = (titleObj) => {\n  $title.text(titleObj.value);\n};\n\nlet renderTitle = (titleObj) => {\n  $title.text(titleObj.title);\n};\n\nlet defRenderCount = (countObj) => {\n  let $targetCountObj = $(`.js-count-${countObj.id}`);\n\n  $targetCountObj.text(countObj.value);\n  checkFontSize($targetCountObj);\n};\n\nlet renderCount = (countObj) => {\n  for (let key in countObj){\n    if(parseInt($(`.js-count-${key}`).text(), 10) !== countObj[key]) {\n      let $targetCountObj = $(`.js-count-${key}`);\n      let $targetCountObjPost = $targetCountObj.closest('.js-post');\n\n      $targetCountObjPost.addClass('is-animated');\n      $targetCountObj.text(countObj[key]);\n      checkFontSize($targetCountObj);\n    }\n  }\n};\n\nlet defRenderName = (nameObj) => {\n  $(`.js-name-${nameObj.id}`).text(nameObj.value);\n};\n\nlet renderName = (nameObj) => {\n  for (let key in nameObj){\n    $(`.js-name-${key}`).text(nameObj[key]);\n  }\n};\n\nlet postActionCount = (initial, countVal) => {\n  let arg = {};\n  arg[initial] = countVal;\n  show();\n    refCount.update(arg)\n      .then((res)=>{\n        setTimeout(() => {\n          hide();\n        }, 300);\n      });\n};\n\nlet postActionComment = (commentVal) => {\n  let arg = {};\n  arg['comment'] = commentVal;\n\n  refComment.push(arg)\n    .then((res)=>{\n      //console.log(res);\n    });\n};\n\n/*\n * カウント表示/非表示判定\n */\n\n/*\n * 集計停止判定\n */\n\n/*\n * クリックイベント\n * ・アルファベット桜花\n * ・コメント送信\n * ・初期読み込み\n * ・pushイベント検知\n */\n$post.on('click', (e) => {\n  if (countStop) {\n    return;\n  }\n  let initial = $(e.currentTarget).data('initial');\n  countObj[initial] = countObj[initial] + 1;\n  postActionCount(initial, countObj[initial]);\n});\n\n$form.on('submit', (e) => {\n  e.preventDefault();\n  let commentVal = $(e.currentTarget).find('.js-comment').val();\n\n  postActionComment(commentVal);\n\n  // データベースに送信後は値を空にする\n  $(e.currentTarget).find('.js-comment').val('');\n});\n\nrefTitle.on(\"child_added\", (snapshot) => {\n  // データベースと同期\n  //titleObj[snapshot.key] = snapshot.val();\n  //renderTitle(titleObj);\n  defRenderTitle({\n    id: snapshot.key,\n    value: snapshot.val()\n  });\n});\n\nrefTitle.on(\"value\", (snapshot) => {\n  renderTitle(snapshot.val());\n});\n\n//refName.on(\"child_added\", (snapshot) => {\n//  // データベースと同期\n//  nameObj[snapshot.key] = snapshot.val();\n//  renderName(nameObj);\n//});\n\nrefName.on(\"child_added\", (snapshot) => {\n  // データベースと同期\n  //nameObj[snapshot.key] = snapshot.val();\n\n  defRenderName({\n    id: snapshot.key,\n    value: snapshot.val()\n  });\n});\n\nrefName.on(\"value\", (snapshot) => {\n  renderName(snapshot.val());\n});\n\nrefCount.on(\"child_added\", (snapshot) => {\n  console.log('hoge');\n  // データベースと同期\n  countObj[snapshot.key] = snapshot.val();\n\n  defRenderCount({\n    id: snapshot.key,\n    value: snapshot.val()\n  });\n});\n\nrefCount.on(\"value\", (snapshot) => {\n  console.log('fuga');\n  let snapshotObj = snapshot.val();\n\n  // データベースと同期\n  for (let key in snapshotObj){\n    countObj[key] = snapshotObj[key];\n  }\n\n  renderCount(snapshot.val());\n});\n\nrefView.on(\"child_added\", (snapshot) => {\n  if(snapshot.val() === true) {\n    $count.removeClass('is-hide');\n  } else {\n    $count.addClass('is-hide');\n  }\n});\n\nrefView.on(\"value\", (snapshot) => {\n  if(snapshot.val().view === true) {\n    $count.removeClass('is-hide');\n  } else {\n    $count.addClass('is-hide');\n  }\n});\n\nrefCountStop.on(\"child_added\", (snapshot) => {\n  if(snapshot.val() === true) {\n    countStop = true;\n    showCountStop();\n  } else {\n    countStop = false;\n    hideCountStop();\n  }\n});\n\nrefCountStop.on(\"value\", (snapshot) => {\n  if(snapshot.val().countStop === true) {\n    countStop = true;\n    showCountStop();\n  } else {\n    countStop = false;\n    hideCountStop();\n  }\n});\n\n/*\n * その他\n */\nlet checkFontSize = (targetCountObj) => {\n  let $countTextLength = targetCountObj.text().length;\n  if($countTextLength > 3) {\n    targetCountObj.addClass('count__num--long');\n  } else {\n    targetCountObj.removeClass('count__num--long');\n  }\n};\n\nlet show = () => {\n  $layer.removeClass('dn');\n  $layerLoading.removeClass('dn');\n  $layer.addClass('is-show');\n};\n\nlet hide = () => {\n  $layer.removeClass('is-show').one(TRANSITION_END, () => {\n    $layerLoading.addClass('dn');\n    $layer.addClass('dn');\n  });\n};\n\nlet showCountStop = () => {\n  $layer.removeClass('dn');\n  $layerCountStop.removeClass('dn');\n  $layer.addClass('is-show');\n};\n\nlet hideCountStop = () => {\n  $layer.removeClass('is-show').one(TRANSITION_END, () => {\n    $layerCountStop.addClass('dn');\n    $layer.addClass('dn');\n  });\n};\n\n$post.on(ANIMATION_END, (e) => {\n  $(e.currentTarget).removeClass('is-animated');\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/user.js"],"sourceRoot":""}